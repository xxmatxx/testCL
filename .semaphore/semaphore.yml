version: v1.0
name: Run in Docker
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
  containers:
    - name: main
      image: 'semaphoreci/node:10'
    - name: database
      image: 'postgres:11'
blocks:
  - name: Hello World
    task:
      jobs:
        - name: Test job
          commands:
            - GODOT_VERSION=3.2.1
            - 'GODOT_BIN=Godot_v${GODOT_VERSION}-stable_linux_headless.64'
            - 'GODOT_ZIP=${GODOT_BIN}.zip'
            - 'GODOT_URL=https://downloads.tuxfamily.org/godotengine/${GODOT_VERSION}/${GODOT_ZIP}'
            - 'curl ${GODOT_URL} --output ${GODOT_ZIP}'
            - 'unzip ${GODOT_ZIP}'
            - 'chmod +x ${GODOT_BIN}'
            - checkout
            - cd ..
            - ls -al
            - './${GODOT_BIN} -s --path .\testCL addons/gut/gut_cmdln.gd -gdir=res://test -glog=3'
    dependencies: []
